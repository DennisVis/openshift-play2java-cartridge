#!/bin/bash -eu

case "$1" in
  -v|--version)
    version="$2"
esac

# Parse arguments
source "${OPENSHIFT_PLAY2JAVA_DIR}lib/util"
#parse_args $@

# Don't set -u until after the above arg parsing is complete
set -u

# Create log directory
mkdir ${OPENSHIFT_PLAY2JAVA_DIR}logs

# Create enviroment variables
echo "${OPENSHIFT_PLAY2JAVA_DIR}logs" > ${OPENSHIFT_PLAY2JAVA_DIR}env/OPENSHIFT_PLAY2JAVA_LOG_DIR
echo "$version" > ${OPENSHIFT_PLAY2JAVA_DIR}env/PLAY_VERSION
< /dev/urandom tr -dc a-zA-Z0-9@#$%*-_+=~ | head -c64 > ${OPENSHIFT_PLAY2JAVA_DIR}env/CRYPTO_KEY

###
pushd $OPENSHIFT_PLAY2JAVA_DIR > /dev/null
for dir in logs tmp pid; do
	mkdir -p $dir
done
popd > /dev/null
